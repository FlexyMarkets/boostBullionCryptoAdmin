import{r as p,j as e,V as A,J as f,K as D,C as M,W as N,X as L,S as x,Y as S,Z as O,_ as C,$ as k,a0 as P,a1 as W,I as _}from"./index-DJkOrddM.js";import{c as B,u as G,L as Y,D as z,M as U,F as V,a as E,w as H}from"./xlsx-Buwt_MlR.js";import{M as J}from"./MenuItem-C6Me-RSo.js";import{S as y}from"./Selector-DvL7NQ9h.js";import{G as v}from"./Grid2-DMXzHL4Q.js";import{d as w,A as K}from"./AdapterDayjs-BpTkHU8-.js";import"./Close-ChGvmQUK.js";import"./ExpandMore-BDq_mFfM.js";import"./Tooltip-BXI4G3BD.js";import"./Radio-BnGDMS9i.js";import"./TextField-B_T7QZCB.js";import"./Select-BO3C6JoM.js";import"./Divider-BTZhOkRD.js";function $({btnName:t,btnSx:o,type:a="button",color:j,startIcon:g,Content:T,modalWidth:n,contentData:b,onOpen:c}){const[d,h]=p.useState(!1),m=()=>{c&&c(),h(!0)},u=()=>h(!1),r={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:n||600,bgcolor:"background.paper",borderRadius:".5rem",boxShadow:24,p:3};return e.jsxs("div",{children:[a==="button"?e.jsx(A,{variant:"contained",size:"small",startIcon:g,onClick:m,sx:{...o,textTransform:"none"},children:t}):a==="icon"?p.createElement(t,{onClick:m,sx:{...o,cursor:"pointer"}}):e.jsx(f,{onClick:m,sx:{cursor:"pointer",color:j},children:t}),e.jsx(J,{keepMounted:!0,open:d,onClose:u,"aria-labelledby":"keep-mounted-modal-title","aria-describedby":"keep-mounted-modal-description",children:e.jsx(D,{sx:r,children:e.jsx(T,{data:b})})})]})}const Q=k({transactionId:P().trim().min(1,"Please type your transfer id"),status:P().trim().min(1,"Please type transactionStatus")}),X=["APPROVED","REJECTED"];function Z({data:t}){const o=M(),a={transactionId:t,status:""},{register:j,setValue:g,handleSubmit:T,watch:n,reset:b,formState:{errors:c}}=N({resolver:O(Q),defaultValues:a}),[d,{isLoading:h}]=L(),m=async u=>{var r;try{const s=await d(u).unwrap();s!=null&&s.status&&(b(a),o(C({open:!0,message:s==null?void 0:s.message,severity:"success"})))}catch(s){s!=null&&s.data&&o(C({open:!0,message:((r=s==null?void 0:s.data)==null?void 0:r.message)||"Failed to submit. Please try again later.",severity:"error"}))}};return e.jsxs(x,{children:[e.jsx(f,{variant:"h6",fontWeight:"bold",mb:"1.2rem",children:"Edit transaction"}),e.jsxs(x,{gap:"2rem",component:"form",onSubmit:T(m),children:[e.jsx(v,{container:!0,size:12,spacing:2,children:e.jsxs(v,{item:!0,size:{xs:12,sm:6},children:[e.jsx(S,{sx:{mb:".5rem"},children:"Status *"}),e.jsx(y,{items:X,value:n("status"),shouldBeFullWidth:!0,onChange:u=>g("status",u.target.value,{shouldValidate:!0})}),c.transactionStatus&&e.jsx(f,{color:"error",fontSize:"13px",children:c.transactionStatus.message})]})}),e.jsx(A,{variant:"contained",size:"small",type:"submit",disabled:h,sx:{textTransform:"capitalize",width:"5rem",boxShadow:"none",bgcolor:"primary.main",fontSize:"1rem",color:"white","&:hover":{boxShadow:"none"}},children:"Submit"})]})]})}const l=B(),q=[l.display({header:"Name",size:150,Cell:({row:t})=>{var o,a;return e.jsx(f,{children:(a=(o=t==null?void 0:t.original)==null?void 0:o.user)==null?void 0:a.name})}}),l.accessor("balanceType",{header:"Balance Type",size:120}),l.accessor("transactionType",{header:"Transaction Type",size:250}),l.accessor("amount",{header:"Amount",size:150}),l.accessor("status",{header:"Status",size:150}),l.accessor("description",{header:"Description",size:250}),l.accessor("createdAt",{header:"Registration Date",size:200,Cell:({row:t})=>e.jsx(f,{children:new Date(t.original.createdAt).toLocaleString()})}),l.display({header:"Action",Cell:({row:t})=>t.original.transactionType==="WITHDRAW"&&t.original.status==="PENDING"&&e.jsx($,{Content:Z,contentData:t.original._id,btnName:"Edit"})})],ee=["PENDING","COMPLETED","REJECTED"],te=["BURN","DEPOSIT","TRADE","WITHDRAW","CONVERT-REWARD","PROFIT-SHARING-INCOME","SIGNUP-BONUS","LEVEL-AIR-DROP","REFERAL-INCOME","FUND-TRANSFER","RANK-REWARD","RANK-UPGRADE-BONUS","DELEGATED-REWARD","SWAP-MAIN-TO-TRADE","SWAP-AFFLIATE-TO-TRADE"],ae=t=>{const o=E.json_to_sheet(t),a=E.book_new();E.book_append_sheet(a,o,"Sheet1"),H(a,"transactionList.xlsx")};function fe(){var s,R;const[t,o]=p.useState({pageIndex:0,pageSize:10}),[a,j]=p.useState({status:"",transactionType:"",fromDate:null,toDate:null}),g=a.fromDate?w(a.fromDate).format("YYYY-MM-DD"):void 0,T=a.toDate?w(a.toDate).format("YYYY-MM-DD"):void 0,{data:n,isLoading:b,isError:c}=W({page:t.pageIndex+1,sizePerPage:t.pageSize,...a,startDate:g,endDate:T}),d=((s=n==null?void 0:n.data)==null?void 0:s.docs)||[],h=p.useMemo(()=>q,[]),m=p.useMemo(()=>d,[d]),u=G({columns:h,data:m,enableColumnFilters:!1,enableSorting:!1,enableColumnActions:!1,manualPagination:!0,manualFiltering:!0,rowCount:((R=n==null?void 0:n.data)==null?void 0:R.totalDocs)||0,state:{pagination:t,isLoading:b,showAlertBanner:c},onPaginationChange:o,columnFilterDisplayMode:"popover",enableGlobalFilter:!1,paginationDisplayMode:"pages",positionToolbarAlertBanner:"bottom",renderTopToolbarCustomActions:()=>e.jsx(D,{sx:{display:"flex",gap:2,padding:1,flexWrap:"wrap"},children:e.jsx(A,{variant:"contained",onClick:()=>ae(d),startIcon:e.jsx(V,{sx:{color:"white"}}),sx:{textTransform:"none",color:"white",boxShadow:"none",bgcolor:"primary.main","&:hover":{boxShadow:"none"}},children:"Excel"})})}),r=p.useCallback((i,F)=>{j(I=>({...I,[i]:F}))},[]);return e.jsxs(_,{sx:{mt:"100px"},children:[e.jsx(f,{variant:"h5",fontWeight:700,fontSize:"1.8rem",mb:4,children:"Transaction List"}),e.jsxs(D,{sx:{display:"flex",flexDirection:{xs:"column",lg:"row"},gap:2,flexWrap:"wrap",mb:4},children:[e.jsxs(D,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},gap:2},children:[e.jsxs(x,{children:[e.jsx(S,{sx:{mb:.5,fontSize:12},children:"Status"}),e.jsx(y,{items:ee,value:a.status,onChange:i=>r("status",i.target.value),width:{xs:"100%",sm:200}})]}),e.jsxs(x,{children:[e.jsx(S,{sx:{mb:.5,fontSize:12},children:"Transaction type"}),e.jsx(y,{items:te,value:a.transactionType,onChange:i=>r("transactionType",i.target.value),width:{xs:"100%",sm:200}})]})]}),e.jsx(Y,{dateAdapter:K,children:e.jsxs(D,{sx:{display:"flex",gap:2,flexDirection:{xs:"column",sm:"row"}},children:[e.jsxs(x,{children:[e.jsx(S,{sx:{mb:.5,fontSize:12},children:"From"}),e.jsx(z,{value:a.fromDate,onChange:i=>r("fromDate",i),slotProps:{textField:{size:"small"},field:{clearable:!0}}})]}),e.jsxs(x,{children:[e.jsx(S,{sx:{mb:.5,fontSize:12},children:"To"}),e.jsx(z,{value:a.toDate,onChange:i=>r("toDate",i),slotProps:{textField:{size:"small"},field:{clearable:!0}}})]})]})})]}),e.jsx(x,{sx:{mt:4,borderRadius:2,overflow:"hidden"},children:e.jsx(U,{table:u})})]})}export{fe as default};
